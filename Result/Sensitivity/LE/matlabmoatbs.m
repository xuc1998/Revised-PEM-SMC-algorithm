% This file contains modified means of gradients
% and also their spreads based on bootstraping.
% to select the most important ones to display,
% set sortFlag = 1 and set nn to be the number
% of inputs to display.

sortFlag = 0;
nn = 40;
Means = [
  0.0000000000000000e+00
  2.2425230478270209e-02
  3.1542348154461906e-02
  1.2158549174583073e-02
  4.4003184337345638e-02
  3.6396766442322745e-02
  2.9398346752965418e-02
  2.5748600841262598e-02
  3.8313177845333786e-02
  1.0954466384149775e-03
  0.0000000000000000e+00
  4.3645332327692035e-03
  2.1869370079323741e-02
  0.0000000000000000e+00
  2.3746529942377261e-03
  2.2618589562301669e-03
  7.2538018629693122e-03
  1.8752613604382379e-02
  3.1153341282519832e-03
  1.1761239372011926e-03
  0.0000000000000000e+00
  1.6423034539022239e-03
  0.0000000000000000e+00
  1.1960454465524345e-03
  0.0000000000000000e+00
  4.6165994927744166e-03
  0.0000000000000000e+00
  1.7086105746539975e-03
  3.9456304779486627e-03
  3.3013593397736058e-03
  2.6300537834186553e-03
  1.5104509855797596e-02
  8.5423505322027055e-02
  1.0410367494179001e-01
  4.7010503398304863e-02
  5.8763382997503139e-02
  4.0955759656339120e-03
  0.0000000000000000e+00
  1.6391850435945596e-07
  3.2117473056352729e-02
];
Stds = [
  0.0000000000000000e+00
  4.6170306956996223e-03
  1.0649009158315259e-02
  3.3495650187233650e-03
  1.9418276659964203e-02
  5.9981124977606885e-03
  9.0647914564027168e-03
  1.3232868367727989e-02
  8.0805240528268145e-03
  2.1788164297202218e-04
  0.0000000000000000e+00
  1.5107178968709104e-03
  6.7835646578538657e-03
  0.0000000000000000e+00
  4.1716626334927783e-04
  5.3529070038241895e-04
  1.3451658034462678e-03
  1.9337316353096547e-03
  1.1751376964719451e-03
  6.0737957359754513e-04
  0.0000000000000000e+00
  4.7323819633017809e-04
  0.0000000000000000e+00
  3.2699613460868029e-04
  0.0000000000000000e+00
  1.4292286984479185e-03
  0.0000000000000000e+00
  7.0087800576724534e-04
  1.5442994327265311e-03
  1.6341962869959419e-03
  1.1097501726336607e-03
  2.5461798940327658e-03
  1.8085023792505098e-02
  2.6206740093704540e-02
  1.0978487442062751e-02
  1.4767622018152132e-02
  1.0672951061349873e-03
  0.0000000000000000e+00
  1.6284081339681128e-07
  2.2310218735954887e-02
];
  Str = {'p1','p2','p3','p4','p5','p6','p7','p8','p9','p10','p11','p12','p13','p14','p15','p16','p17','p18','p19','p20','p21','p22','p23','p24','p25','p26','p27','p28','p29','p30','p31','p32','p33','p34','p35','p36','p37','p38','p39','p40'};
if exist('noCLF') 
   hold off
else
   clf
end;
if (sortFlag == 1)
  [Means, I2] = sort(Means,'descend');
  Stds = Stds(I2);
  I2 = I2(1:nn);
  Means = Means(1:nn);
  Stds = Stds(1:nn);
  Str  = Str(I2);
end
ymin = min(Means-Stds);
ymax = max(Means+Stds);
h2 = 0.05 * (ymax - ymin);
bar(Means,0.8);
for ii = 1:nn
   if (ii == 1)
   hold on
   end;
   XX = [ii ii];
   YY = [Means(ii)-Stds(ii) Means(ii)+Stds(ii)];
   plot(XX,YY,'-ko','LineWidth',3.0,'MarkerEdgeColor','k','MarkerFaceColor','g','MarkerSize',12)
end;
axis([0 nn+1 ymin ymax])
set(gca,'XTickLabel',[]);
th=text(1:nn, repmat(ymin-0.05*(ymax-ymin),nn,1),Str,'HorizontalAlignment','left','rotation',90);
set(th, 'fontsize', 12)
set(th, 'fontweight', 'bold')
set(gca,'linewidth',2)
set(gca,'fontweight','bold')
set(gca,'fontsize',12)
grid on
box on
title('Modified Means Plot (bootstrap)','FontWeight','bold','FontSize',12)
ylabel('Modified Means (of gradients)','FontWeight','bold','FontSize',12)
   hold off
