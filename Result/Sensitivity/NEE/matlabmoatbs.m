% This file contains modified means of gradients
% and also their spreads based on bootstraping.
% to select the most important ones to display,
% set sortFlag = 1 and set nn to be the number
% of inputs to display.

sortFlag = 0;
nn = 40;
Means = [
  0.0000000000000000e+00
  6.0164879397068563e-02
  1.4725949585349782e-01
  5.2733207135400403e-02
  6.4905148882441990e-02
  5.7235126688740347e-02
  3.1255247537686881e-02
  7.4244400242192921e-02
  1.2924969547304921e-01
  7.0559982785632644e-03
  0.0000000000000000e+00
  1.4830207427122339e-02
  3.9899408333322811e-02
  0.0000000000000000e+00
  1.4247382905857656e-03
  1.3025848050715111e-03
  4.9113840657426619e-02
  3.8089738572827818e-02
  5.0080274042355677e-03
  7.3048955287941331e-03
  0.0000000000000000e+00
  1.7058618100582244e-03
  0.0000000000000000e+00
  1.1119696804202507e-03
  0.0000000000000000e+00
  1.2386083712203776e-03
  0.0000000000000000e+00
  3.6791029353737688e-02
  5.4644991042777799e-02
  4.3558524859066444e-02
  6.0247336921667144e-02
  1.4014910322612692e-02
  1.2477077367256022e+00
  1.1418569257792821e+00
  9.5305064527528335e-02
  6.0794435590574014e-02
  6.1774916034414713e-02
  0.0000000000000000e+00
  1.1555491251602395e-08
  7.6130308307236702e-02
];
Stds = [
  0.0000000000000000e+00
  2.4782610048912541e-02
  4.4628037139030914e-02
  1.8145610103830690e-02
  2.6185438057568605e-02
  2.4316995537779350e-02
  1.3101992815272015e-02
  2.2999997518510396e-02
  5.4801590766625483e-02
  2.8611284275037873e-03
  0.0000000000000000e+00
  8.1695296219797143e-03
  1.1583424571549816e-02
  0.0000000000000000e+00
  1.6453464066205382e-04
  1.9480242608005603e-04
  8.8825064617356151e-03
  1.8360945999044264e-02
  1.6255762992107424e-03
  3.2087717103390576e-03
  0.0000000000000000e+00
  6.4716760652248581e-04
  0.0000000000000000e+00
  4.9678634047092319e-04
  0.0000000000000000e+00
  4.3520517684125494e-04
  0.0000000000000000e+00
  1.2615876158764073e-02
  1.5427360526777980e-02
  1.3678959180719983e-02
  1.8686766825962223e-02
  6.0599514260916022e-03
  2.1811797683925721e-01
  2.6995233437522526e-01
  3.9458898659739290e-02
  1.5237519989697010e-02
  1.6884052443893665e-02
  0.0000000000000000e+00
  1.1336707015597217e-08
  5.5806427430733996e-02
];
  Str = {'p1','p2','p3','p4','p5','p6','p7','p8','p9','p10','p11','p12','p13','p14','p15','p16','p17','p18','p19','p20','p21','p22','p23','p24','p25','p26','p27','p28','p29','p30','p31','p32','p33','p34','p35','p36','p37','p38','p39','p40'};
if exist('noCLF') 
   hold off
else
   clf
end;
if (sortFlag == 1)
  [Means, I2] = sort(Means,'descend');
  Stds = Stds(I2);
  I2 = I2(1:nn);
  Means = Means(1:nn);
  Stds = Stds(1:nn);
  Str  = Str(I2);
end
ymin = min(Means-Stds);
ymax = max(Means+Stds);
h2 = 0.05 * (ymax - ymin);
bar(Means,0.8);
for ii = 1:nn
   if (ii == 1)
   hold on
   end;
   XX = [ii ii];
   YY = [Means(ii)-Stds(ii) Means(ii)+Stds(ii)];
   plot(XX,YY,'-ko','LineWidth',3.0,'MarkerEdgeColor','k','MarkerFaceColor','g','MarkerSize',12)
end;
axis([0 nn+1 ymin ymax])
set(gca,'XTickLabel',[]);
th=text(1:nn, repmat(ymin-0.05*(ymax-ymin),nn,1),Str,'HorizontalAlignment','left','rotation',90);
set(th, 'fontsize', 12)
set(th, 'fontweight', 'bold')
set(gca,'linewidth',2)
set(gca,'fontweight','bold')
set(gca,'fontsize',12)
grid on
box on
title('Modified Means Plot (bootstrap)','FontWeight','bold','FontSize',12)
ylabel('Modified Means (of gradients)','FontWeight','bold','FontSize',12)
   hold off
