% This file contains modified means of gradients
% and also their spreads based on bootstraping.
% to select the most important ones to display,
% set sortFlag = 1 and set nn to be the number
% of inputs to display.

sortFlag = 0;
nn = 40;
Means = [
  0.0000000000000000e+00
  2.2732804357607134e-02
  8.3229245185975284e-02
  3.5325324471692766e-02
  9.3661017758182863e-02
  3.7090920776592741e-02
  3.8256637268333171e-02
  4.5351172413500472e-02
  9.6343624064856179e-02
  3.2702213976007100e-03
  0.0000000000000000e+00
  9.4700544930777994e-03
  3.9686856984103125e-02
  0.0000000000000000e+00
  1.6989027995876489e-03
  1.8889929887891421e-03
  2.3687619333056780e-02
  1.9868441069447951e-02
  4.1635997014944255e-03
  5.9600473917645058e-03
  0.0000000000000000e+00
  3.3713948068464237e-03
  0.0000000000000000e+00
  5.8868309234497117e-03
  0.0000000000000000e+00
  4.3638067137070869e-03
  0.0000000000000000e+00
  2.9760053903705050e-02
  6.4456749765694404e-02
  2.5663467724674944e-02
  5.4683312008268044e-02
  2.1345811692380937e-02
  1.1459088637162074e+00
  1.0656034047628293e+00
  1.3003516395857748e-01
  7.4595652576218738e-02
  8.0915734999526770e-02
  0.0000000000000000e+00
  2.0134060756826835e-07
  2.6893660441305989e-01
];
Stds = [
  0.0000000000000000e+00
  4.7504314394230217e-03
  3.2319308626100350e-02
  1.6311044496825685e-02
  3.0002878462596545e-02
  9.8981314087771242e-03
  1.2024098186905148e-02
  1.5865955328444297e-02
  2.3196314231800332e-02
  1.2675084106911897e-03
  0.0000000000000000e+00
  5.0460859747168858e-03
  7.7244972808148526e-03
  0.0000000000000000e+00
  3.5968909548902256e-04
  5.2125385851666407e-04
  5.4374935136126722e-03
  6.0747999661677531e-03
  1.1226546985395266e-03
  2.2759283530129808e-03
  0.0000000000000000e+00
  1.1765227464909701e-03
  0.0000000000000000e+00
  1.8589281598204298e-03
  0.0000000000000000e+00
  1.0737440061383652e-03
  0.0000000000000000e+00
  1.2336133176125889e-02
  1.8977981956556849e-02
  8.1728432711921199e-03
  1.3954809615733570e-02
  5.2310306571264429e-03
  2.8172584934199635e-01
  3.2126100491061715e-01
  4.7191906525880130e-02
  1.3201385688682532e-02
  1.6291964704830637e-02
  0.0000000000000000e+00
  1.9117100657250733e-07
  1.0263503295864379e-01
];
  Str = {'p1','p2','p3','p4','p5','p6','p7','p8','p9','p10','p11','p12','p13','p14','p15','p16','p17','p18','p19','p20','p21','p22','p23','p24','p25','p26','p27','p28','p29','p30','p31','p32','p33','p34','p35','p36','p37','p38','p39','p40'};
if exist('noCLF') 
   hold off
else
   clf
end;
if (sortFlag == 1)
  [Means, I2] = sort(Means,'descend');
  Stds = Stds(I2);
  I2 = I2(1:nn);
  Means = Means(1:nn);
  Stds = Stds(1:nn);
  Str  = Str(I2);
end
ymin = min(Means-Stds);
ymax = max(Means+Stds);
h2 = 0.05 * (ymax - ymin);
bar(Means,0.8);
for ii = 1:nn
   if (ii == 1)
   hold on
   end;
   XX = [ii ii];
   YY = [Means(ii)-Stds(ii) Means(ii)+Stds(ii)];
   plot(XX,YY,'-ko','LineWidth',3.0,'MarkerEdgeColor','k','MarkerFaceColor','g','MarkerSize',12)
end;
axis([0 nn+1 ymin ymax])
set(gca,'XTickLabel',[]);
th=text(1:nn, repmat(ymin-0.05*(ymax-ymin),nn,1),Str,'HorizontalAlignment','left','rotation',90);
set(th, 'fontsize', 12)
set(th, 'fontweight', 'bold')
set(gca,'linewidth',2)
set(gca,'fontweight','bold')
set(gca,'fontsize',12)
grid on
box on
title('Modified Means Plot (bootstrap)','FontWeight','bold','FontSize',12)
ylabel('Modified Means (of gradients)','FontWeight','bold','FontSize',12)
   hold off
